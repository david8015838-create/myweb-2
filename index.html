<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Portfolio | Immersive Journey</title>
    <link rel="manifest" href="/manifest.json">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=Playfair+Display:italic@400;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <style>
        html { scroll-behavior: smooth; }
        @media (hover: hover) and (pointer: fine) {
            html { cursor: none; }
        }
        body { 
            background-color: #000; 
            color: #e5e5e5; 
            margin: 0;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
        }

        /* 3D 容器 */
        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; pointer-events: none; opacity: 0; display: none; }
        
        /* 自定義滑鼠 */
        #cursor-dot {
            width: 8px; height: 8px; background: white; border-radius: 50%;
            position: fixed; pointer-events: none; z-index: 9999;
            transform: translate(-50%, -50%); transition: width 0.3s, height 0.3s, background 0.3s;
            display: none;
        }
        #cursor-outline {
            width: 40px; height: 40px; border: 1px solid rgba(255,255,255,0.3); border-radius: 50%;
            position: fixed; pointer-events: none; z-index: 9998;
            transform: translate(-50%, -50%); transition: all 0.15s ease-out;
            display: none;
        }
        @media (hover: hover) and (pointer: fine) {
            #cursor-dot, #cursor-outline {
                display: block;
            }
        }

        /* 背景設計 */
        .bg-grid {
            background-image: linear-gradient(to right, rgba(255,255,255,0.02) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        .bg-noise {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.04; pointer-events: none;
        }
        .backdrop-blur-md { backdrop-filter: blur(20px); }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        
        /* 手機適配 */
        @media (max-width: 768px) {
            body {
                overflow-x: hidden;
                width: 100%;
                position: relative;
            }
            * {
                max-width: 100vw;
                box-sizing: border-box;
            }
            #web-content {
                overflow-x: hidden;
            }
            main {
                overflow-x: hidden;
                width: 100%;
            }
            nav {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            nav .max-w-7xl {
                padding-left: 0;
                padding-right: 0;
            }
            nav .flex.items-center.gap-8 {
                gap: 0.5rem;
                flex-wrap: wrap;
            }
        }
        
        /* 防止模態框滾動穿透 */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }
        
        /* 確保關閉模態框後恢復滾動 */
        body:not(.modal-open) {
            overflow: auto;
            position: relative;
        }
    </style>
</head>
<body>
    <div id="cursor-dot"></div>
    <div id="cursor-outline"></div>
    <div id="canvas-container"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence, useScroll, useSpring, useInView } = window.Motion;

        const App = () => {
            const [stage, setStage] = useState('intro3d');
            const [waitingStart, setWaitingStart] = useState(true); // 初始狀態：等待辛普森動畫
            const [showTypewriter, setShowTypewriter] = useState(false); // 顯示打字機效果
            const [typewriterText1, setTypewriterText1] = useState(''); // 第一行文字
            const [typewriterText2, setTypewriterText2] = useState(''); // 第二行文字
            const [activeProjectModal, setActiveProjectModal] = useState(false);
            const [activeProjectView, setActiveProjectView] = useState(null);
            const [activeExpModal, setActiveExpModal] = useState(null);
            const [activeCertModal, setActiveCertModal] = useState(null);
            const [iframeScale, setIframeScale] = useState(0.6);
            const [journeyDescription, setJourneyDescription] = useState('');
            const journeyDescriptionRef = useRef(null);
            
            // 經歷描述的打字機效果
            const journeyInView = useInView(journeyDescriptionRef, { once: false, amount: 0.1 });
            
            useEffect(() => {
                const text = "Connecting the dots of experience to foster a vision that stops learning.";
                
                if (!journeyInView) {
                    setJourneyDescription('');
                    return;
                }
                
                let index = 0;
                setJourneyDescription('');
                const interval = setInterval(() => {
                    if (index < text.length) {
                        setJourneyDescription(text.substring(0, index + 1));
                        index++;
                    } else {
                        clearInterval(interval);
                    }
                }, 50); // 每個字50ms，比之前的100ms快
                
                return () => clearInterval(interval);
            }, [journeyInView]);
            
            // 根據屏幕大小動態調整iframe縮放
            useEffect(() => {
                const updateScale = () => {
                    const isMobile = window.innerWidth < 1024; // lg breakpoint
                    
                    if (isMobile) {
                        // 手機：使用較小的縮放，讓內容完整顯示
                        setIframeScale(0.6);
                    } else {
                        // 電腦：使用與手機相同的縮放比例，確保內容完整顯示
                        // 這樣可以確保在電腦上也能看到完整的小程序內容
                        setIframeScale(0.6);
                    }
                };
                
                updateScale();
                window.addEventListener('resize', updateScale);
                return () => window.removeEventListener('resize', updateScale);
            }, [activeProjectView]);

            const threeInstance = useRef({ scene: null, camera: null, renderer: null, tv: null, noiseCanvas: null, noiseTex: null, noiseCtx: null, staticActive: false });
            const staticCanvasRef = useRef(null);
            const staticAnimRef = useRef(null);
            const staticCtxRef = useRef(null);

            useEffect(() => {
                const container = document.getElementById('canvas-container');
                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x050608);
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.set(0, 2.5, 6.8);
                camera.lookAt(-0.8, 1.5, 0.3);
                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                container.appendChild(renderer.domElement);
                scene.add(new THREE.AmbientLight(0xffffff, 0.2));
                const tv = new THREE.Group();
                const frame = new THREE.Mesh(new THREE.BoxGeometry(3.6, 2, 0.1), new THREE.MeshStandardMaterial({ color: 0x000000 }));
                const screen = new THREE.Mesh(new THREE.PlaneGeometry(3.4, 1.8), new THREE.MeshBasicMaterial({ color: 0x000000 }));
                screen.position.z = 0.06;
                screen.name = "screen";
                tv.add(frame, screen);
                tv.position.set(-0.8, 1.5, 0.3);
                scene.add(tv);
                const floor = new THREE.Mesh(new THREE.PlaneGeometry(20, 20), new THREE.MeshStandardMaterial({ color: 0x050505, roughness: 0.9, metalness: 0.0 }));
                floor.rotation.x = -Math.PI / 2;
                scene.add(floor);
                const wallBack = new THREE.Mesh(new THREE.PlaneGeometry(20, 10), new THREE.MeshStandardMaterial({ color: 0xead59e }));
                wallBack.position.set(0, 2.5, -1);
                wallBack.rotation.y = Math.PI;
                scene.add(wallBack);
                const rug = new THREE.Mesh(new THREE.PlaneGeometry(6, 3.5), new THREE.MeshStandardMaterial({ color: 0x5ec6e8 }));
                rug.rotation.x = -Math.PI / 2;
                rug.position.set(0, 0.01, 3.2);
                scene.add(rug);
                const teaWood = new THREE.MeshStandardMaterial({ color: 0x7a4a2a, roughness: 0.8 });
                const teaTable = new THREE.Group();
                const teaTop = new THREE.Mesh(new THREE.CylinderGeometry(0.6, 0.6, 0.06, 24), teaWood);
                const teaPedestal = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.1, 0.5, 16), teaWood);
                teaTop.position.y = 0;
                teaPedestal.position.y = -0.25;
                teaTable.add(teaTop, teaPedestal);
                teaTable.position.set(-0.2, 0.52, 3.0);
                scene.add(teaTable);
                const matBase = new THREE.MeshStandardMaterial({ color: 0x2b5d3b, roughness: 0.7, metalness: 0.0 });
                const matCushion = new THREE.MeshStandardMaterial({ color: 0x3c6e47, roughness: 0.75, metalness: 0.0 });
                const matWood = new THREE.MeshStandardMaterial({ color: 0x7a4a2a, roughness: 0.8 });
                const sofa = new THREE.Group();
                const seatBase = new THREE.Mesh(new THREE.BoxGeometry(3.05, 0.35, 1.45), matBase);
                seatBase.position.y = 0.35;
                const cushionL = new THREE.Mesh(new THREE.BoxGeometry(1.5, 0.28, 1.4), matCushion);
                cushionL.position.set(-0.77, 0.62, 0);
                const cushionR = cushionL.clone();
                cushionR.position.x = 0.77;
                const bulgeL = new THREE.Mesh(new THREE.SphereGeometry(0.22, 24, 16), matCushion);
                bulgeL.scale.set(1.3, 0.5, 1.2);
                bulgeL.position.set(-0.77, 0.78, 0);
                const bulgeR = bulgeL.clone();
                bulgeR.position.x = 0.77;
                const backL = new THREE.Mesh(new THREE.BoxGeometry(1.5, 0.75, 0.32), matBase);
                backL.position.set(-0.77, 1.1, -0.6);
                const backR = backL.clone();
                backR.position.x = 0.77;
                const armBodyL = new THREE.Mesh(new THREE.CylinderGeometry(0.22, 0.22, 1.5, 20), matBase);
                armBodyL.rotation.z = Math.PI / 2;
                armBodyL.position.set(-1.72, 0.62, 0);
                const armFrontL = new THREE.Mesh(new THREE.SphereGeometry(0.28, 24, 16), matBase);
                armFrontL.position.set(-1.92, 0.62, 0.45);
                const armBodyR = armBodyL.clone();
                armBodyR.position.x = 1.72;
                const armFrontR = armFrontL.clone();
                armFrontR.position.x = 1.92;
                const legPositions = [
                    [-1.35, 0.1, 0.6], [1.35, 0.1, 0.6],
                    [-1.35, 0.1, -0.6], [1.35, 0.1, -0.6]
                ];
                const legs = legPositions.map(p => {
                    const leg = new THREE.Mesh(new THREE.CylinderGeometry(0.09, 0.11, 0.22, 12), matWood);
                    leg.position.set(p[0], p[1], p[2]);
                    return leg;
                });
                const pillow = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.2, 0.35), matCushion);
                pillow.position.set(0.25, 0.9, 0.25);
                pillow.rotation.z = -0.2;
                sofa.add(seatBase, cushionL, cushionR, bulgeL, bulgeR, backL, backR, armBodyL, armFrontL, armBodyR, armFrontR, pillow, ...legs);
                sofa.position.set(0, 0, 4);
                sofa.rotation.y = Math.PI;
                scene.add(sofa);
                const person = new THREE.Group();
                person.add(new THREE.Mesh(new THREE.CylinderGeometry(0.3, 0.4, 1), new THREE.MeshStandardMaterial({ color: 0x0a0a0a })));
                const head = new THREE.Mesh(new THREE.SphereGeometry(0.25), new THREE.MeshStandardMaterial({ color: 0x0a0a0a }));
                head.position.y = 0.7;
                person.add(head);
                person.position.set(-0.6, 0.9, 4.1);
                person.rotation.y = Math.PI;
                scene.add(person);
                const noiseCanvas = document.createElement('canvas');
                noiseCanvas.width = 256;
                noiseCanvas.height = 128;
                const noiseCtx = noiseCanvas.getContext('2d');
                const noiseTex = new THREE.CanvasTexture(noiseCanvas);
                noiseTex.wrapS = THREE.ClampToEdgeWrapping;
                noiseTex.wrapT = THREE.ClampToEdgeWrapping;
                noiseTex.minFilter = THREE.NearestFilter;
                noiseTex.magFilter = THREE.NearestFilter;
                threeInstance.current = { scene, camera, renderer, tv, noiseCanvas, noiseTex, noiseCtx, staticActive: false };
                const animate = () => {
                    requestAnimationFrame(animate);
                    if (threeInstance.current.staticActive && threeInstance.current.noiseCtx) {
                        const ctx = threeInstance.current.noiseCtx;
                        const w = threeInstance.current.noiseCanvas.width;
                        const h = threeInstance.current.noiseCanvas.height;
                        const imgData = ctx.createImageData(w, h);
                        for (let i = 0; i < imgData.data.length; i += 4) {
                            const v = Math.random() * 255;
                            imgData.data[i] = v;
                            imgData.data[i + 1] = v;
                            imgData.data[i + 2] = v;
                            imgData.data[i + 3] = 255;
                        }
                        ctx.putImageData(imgData, 0, 0);
                        threeInstance.current.noiseTex.needsUpdate = true;
                    }
                    renderer.render(scene, camera);
                };
                animate();
                const handleResize = () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                };
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            // 監聽辛普森動畫完成事件
            useEffect(() => {
                const setupStaticCanvas = () => {
                    const cvs = document.getElementById('static-overlay');
                    staticCanvasRef.current = cvs;
                    if (!cvs) return;
                    const resize = () => {
                        cvs.width = window.innerWidth;
                        cvs.height = window.innerHeight;
                    };
                    resize();
                    window.addEventListener('resize', resize);
                    return () => window.removeEventListener('resize', resize);
                };
                const teardownResize = setupStaticCanvas();
                const startStaticNoise = () => {
                    const cvs = staticCanvasRef.current;
                    if (!cvs) return;
                    const ctx = cvs.getContext('2d');
                    staticCtxRef.current = ctx;
                    const draw = () => {
                        const w = cvs.width, h = cvs.height;
                        const img = ctx.createImageData(w, h);
                        const data = img.data;
                        for (let i = 0; i < data.length; i += 4) {
                            const v = (Math.random() * 255) | 0;
                            data[i] = v;
                            data[i + 1] = v;
                            data[i + 2] = v;
                            data[i + 3] = 255;
                        }
                        ctx.putImageData(img, 0, 0);
                        staticAnimRef.current = requestAnimationFrame(draw);
                    };
                    draw();
                };
                const stopStaticNoise = () => {
                    if (staticAnimRef.current) {
                        cancelAnimationFrame(staticAnimRef.current);
                        staticAnimRef.current = null;
                    }
                };
                // 打字機效果函數
                const typewriterEffect = (text, setText, delay = 0) => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            let index = 0;
                            const interval = setInterval(() => {
                                if (index < text.length) {
                                    setText(text.substring(0, index + 1));
                                    index++;
                                } else {
                                    clearInterval(interval);
                                    resolve();
                                }
                            }, 100); // 每個字100ms
                        }, delay);
                    });
                };

                const onMessage = (ev) => {
                    console.log('Received message:', ev.data);
                    if (ev.data === 'simpson-finished') {
                        console.log('Starting typewriter sequence...');
                        // 隱藏辛普森動畫
                        setWaitingStart(false);
                        gsap.set("#simpson-overlay", { display: 'none', opacity: 0 });
                        gsap.set("#canvas-container", { display: 'none', opacity: 0 });
                        gsap.set("#static-overlay", { display: 'none', opacity: 0 });
                        
                        // 顯示全黑屏幕和打字機效果
                        setShowTypewriter(true);
                        
                        // 開始打字機效果
                        (async () => {
                            // 第一行：HI! MY NAME IS OWEN
                            await typewriterEffect('HI! MY NAME IS OWEN', setTypewriterText1, 500);
                            // 等待一下再開始第二行
                            await new Promise(resolve => setTimeout(resolve, 500));
                            // 第二行：WELCOME TO MY PORTFOLIO
                            await typewriterEffect('WELCOME TO MY PORTFOLIO', setTypewriterText2, 0);
                            // 等待一下再切換到個人網頁
                            await new Promise(resolve => setTimeout(resolve, 1500));
                            
                            // 淡出打字機效果
                            gsap.to("#typewriter-overlay", {
                                opacity: 0,
                                duration: 0.8,
                                ease: "power2.in",
                                onComplete: () => {
                                    setShowTypewriter(false);
                                    // 切換到個人網頁
                                    setStage('web');
                                    document.body.style.overflow = 'auto';
                                    gsap.set("#web-content", { display: 'block' });
                                    gsap.to("#web-content", { 
                                        opacity: 1, 
                                        duration: 0.8,
                                        ease: "power2.out"
                                    });
                                }
                            });
                        })();
                    }
                };
                window.addEventListener('message', onMessage);
                return () => {
                    window.removeEventListener('message', onMessage);
                    if (teardownResize) teardownResize();
                };
            }, []);

            const start3DSequence = () => {
                console.log('start3DSequence called, threeInstance.current:', threeInstance.current);
                setStage('intro3d');
                const { camera, tv, noiseTex, scene } = threeInstance.current;
                if (!camera || !tv || !noiseTex || !scene) {
                    console.error('Missing 3D objects:', { camera, tv, noiseTex, scene });
                    return;
                }
                console.log('Starting 3D animation sequence...');
                
                const screen = tv.getObjectByName('screen');
                if (!screen) return;
                
                // 設置屏幕為雜訊材質
                screen.material = new THREE.MeshBasicMaterial({ color: 0xaaaaaa, map: noiseTex });
                threeInstance.current.staticActive = true;
                
                // 添加電視發光效果（點光源）
                let tvLight = scene.getObjectByName('tvLight');
                if (!tvLight) {
                    tvLight = new THREE.PointLight(0xffffff, 0, 10);
                    tvLight.position.copy(tv.position);
                    tvLight.position.z += 0.5;
                    tvLight.name = 'tvLight';
                    scene.add(tvLight);
                }
                
                // 獲取電視屏幕的中心位置（世界座標）
                const screenCenter = new THREE.Vector3();
                screen.getWorldPosition(screenCenter);
                
                // 保存初始相機位置和朝向
                const initialPos = camera.position.clone();
                const initialLookAt = new THREE.Vector3(-0.8, 1.5, 0.3);
                
                const timeline = gsap.timeline({ defaults: { ease: "power2.inOut" } });
                
                // 階段1: 屏幕開始發光，雜訊變亮
                timeline.to(screen.material.color, { 
                    r: 1.0,
                    g: 1.0,
                    b: 1.0,
                    duration: 0.6,
                    ease: "power2.out"
                });
                timeline.to(tvLight, { 
                    intensity: 3,
                    duration: 0.6,
                    ease: "power2.out"
                }, "<");
                
                // 同時讓相機開始朝向屏幕中心
                timeline.to({}, {
                    duration: 0.6,
                    onUpdate: function() {
                        const progress = this.progress();
                        const lookAt = new THREE.Vector3().lerpVectors(initialLookAt, screenCenter, progress);
                        camera.lookAt(lookAt);
                    }
                }, "<");
                
                // 階段2: 鏡頭開始移動向電視屏幕
                timeline.to(camera.position, { 
                    x: screenCenter.x,
                    y: screenCenter.y,
                    z: screenCenter.z + 0.8, // 先到屏幕前方
                    duration: 1.5,
                    ease: "power2.inOut"
                }, "<0.3");
                
                // 確保相機持續朝向屏幕中心
                timeline.to({}, {
                    duration: 1.5,
                    onUpdate: function() {
                        camera.lookAt(screenCenter);
                    }
                }, "<");
                
                // 階段3: 屏幕變得更亮，雜訊更強烈
                timeline.to(screen.material.color, {
                    r: 1.5,
                    g: 1.5,
                    b: 1.5,
                    duration: 0.4
                });
                timeline.to(tvLight, {
                    intensity: 8,
                    duration: 0.4
                }, "<");
                
                // 階段4: 鏡頭鑽入屏幕中心（繼續推進）
                timeline.to(camera.position, {
                    x: screenCenter.x,
                    y: screenCenter.y,
                    z: screenCenter.z - 0.2, // 鑽入屏幕
                    duration: 1.2,
                    ease: "power3.in"
                }, "<0.2");
                
                // 持續朝向屏幕中心
                timeline.to({}, {
                    duration: 1.2,
                    onUpdate: function() {
                        camera.lookAt(screenCenter);
                    }
                }, "<");
                
                // 階段5: 屏幕達到最亮，準備切換
                timeline.to(screen.material.color, {
                    r: 2.0,
                    g: 2.0,
                    b: 2.0,
                    duration: 0.3
                });
                timeline.to(tvLight, {
                    intensity: 12,
                    duration: 0.3
                }, "<");
                
                // 階段6: 切換到個人網頁
                timeline.call(() => {
                    setStage('web');
                    document.body.style.overflow = 'auto';
                    threeInstance.current.staticActive = false;
                    // 淡出3D場景
                    gsap.to("#canvas-container", { 
                        opacity: 0, 
                        duration: 0.5,
                        onComplete: () => {
                            gsap.set("#canvas-container", { display: 'none' });
                        }
                    });
                    // 淡入個人網頁
                    gsap.set("#web-content", { display: 'block' });
                    gsap.to("#web-content", { 
                        opacity: 1, 
                        duration: 0.8 
                    });
                });
            };

            useEffect(() => {
                // 檢測是否為桌面設備（支持hover和精確指針）
                const isDesktop = window.matchMedia('(hover: hover) and (pointer: fine)').matches;
                
                if (!isDesktop) {
                    // 手機設備，隱藏鼠標跟隨效果
                    const dot = document.getElementById('cursor-dot');
                    const outline = document.getElementById('cursor-outline');
                    if (dot) dot.style.display = 'none';
                    if (outline) outline.style.display = 'none';
                    return;
                }
                
                // 桌面設備，顯示並啟用鼠標跟隨效果
                const dot = document.getElementById('cursor-dot');
                const outline = document.getElementById('cursor-outline');
                if (!dot || !outline) return;
                
                dot.style.display = 'block';
                outline.style.display = 'block';
                
                const moveCursor = (e) => {
                    dot.style.left = `${e.clientX}px`;
                    dot.style.top = `${e.clientY}px`;
                    outline.animate({ left: `${e.clientX}px`, top: `${e.clientY}px` }, { duration: 500, fill: "forwards" });
                };
                
                window.addEventListener('mousemove', moveCursor);
                return () => window.removeEventListener('mousemove', moveCursor);
            }, []);

            const IMAGES = {
                google: "google project management.JPG",
                googleDataAnalytics: "google data analytics.JPG",
                cia: "CIA獨立公開英文演講.JPG",
                cia2: "cia演講2.jpg",
                tamkang: "淡江畢業證書.JPG",
                n8n: "n8n.JPG",
                finance: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?q=80&w=2511&auto=format&fit=crop",
                toeic: "多益JPG.JPG",
                cebu: "Cebu internantional academy畢業證書.jpg",
                trust: "信託業務專業.JPG",
                bankControl: "銀行內部控制與內部稽核.JPG",
                credit: "初階授信人員.JPG"
            };

            const projects = [
                { 
                    id: 1, 
                    title: "Ledger - Personal Finance", 
                    url: "https://david8015838-create.github.io/ledger-app/",
                    desc: "個人財務管理與信用卡分期追蹤",
                    features: [
                        "預算顯示：當月剩餘、已花費、總預算即時視覺化",
                        "今日消費：顯示現金消費總額與筆數",
                        "信用卡待繳：分期＋結轉餘額含在本月帳單",
                        "新增交易：支援多幣種自動換算、分類、自訂備註",
                        "支付方式：現金即時入帳；信用卡可設定分期與年利率",
                        "分期計算：自動分配到各期，餘數落在最後一期",
                        "歷史記錄：月份切換、即時搜尋、日期分組展開、編輯刪除",
                        "統計分析：圓餅圖比例、分類明細、近6月趨勢圖",
                        "信用卡管理：結帳日、繳款間隔、初始餘額與還款記錄",
                        "定期交易：每日/週/月/年四種頻率，到期自動建立"
                    ]
                },
                { 
                    id: 2, 
                    title: "StockLens Owen", 
                    url: "https://david8015838-create.github.io/stock-lens/",
                    desc: "投資資產追蹤與複利試算工具",
                    features: [
                        "資產管理：支援股票、債券、ETF等多種投資標的，可設定股數、均價、槓桿倍數",
                        "即時追蹤：自動計算總市值、總成本、損益金額與損益百分比",
                        "複利試算：設定每月固定投入金額，系統自動計算複利效果，從第2個月開始計入本金",
                        "債券功能：支援債券類型資產，可設定票面利率與到期日",
                        "槓桿計算：支援槓桿投資，自動計算槓桿後的損益放大效果",
                        "數據視覺化：以直觀方式呈現各資產占比與整體投資組合表現",
                        "快速操作：一鍵新增、編輯、刪除資產，操作流程簡潔高效",
                        "本地儲存：所有數據儲存在本地，保護隱私且無需網路連線"
                    ]
                },
                { 
                    id: 3, 
                    title: "SplitWise Pro - BY OWEN", 
                    url: "https://david8015838-create.github.io/splitwise-pro/",
                    desc: "多人分帳與雲端即時同步",
                    features: [
                        "雲端同步：輸入房間號碼即可建立共享空間，所有成員即時看到最新帳務狀態",
                        "多人分帳：支援任意人數的群組分帳，可設定不同成員的分攤比例",
                        "多種分帳模式：平均分攤、按比例分攤、自訂金額分攤，滿足各種情境需求",
                        "帳務記錄：詳細記錄每筆支出的發起人、參與人、金額與備註",
                        "結算功能：自動計算每位成員應付/應收金額，清楚顯示誰欠誰多少錢",
                        "即時更新：任何成員新增或修改帳務，其他成員立即看到更新，無需手動刷新",
                        "歷史查詢：保留完整的分帳歷史記錄，可隨時查看過往帳務明細",
                        "簡潔介面：直觀的操作介面，快速上手，適合日常使用"
                    ]
                }
            ];

            const experiences = [
                { id: "tamkang", title: "淡江大學 國際企業學系", subtitle: "Bachelor of International Business", tag: "Education", summary: "深研國際市場分析與商業策略思維。", details: "在淡江大學期間，專注於國際市場趨勢分析、跨國企業策略規劃以及數據導向的商業邏輯。", image: IMAGES.tamkang, images: [IMAGES.tamkang] },
                { id: "cia", title: "CIA Language School", subtitle: "獨立公開英文演講", tag: "Public Speaking", summary: "於菲律賓期間完成獨立公開專題演講。", details: "挑戰並完成了一場面向大眾的獨立英文演講，磨練了高壓下的表達力。", image: IMAGES.cia, images: [IMAGES.cia, IMAGES.cia2] },
                { id: "google", title: "Google Career Certificate", subtitle: "Project Management & Data Analytics", tag: "Professional", summary: "取得 Google 官方 PM 與 Data Analytics 認證。", details: "掌握敏捷開發 (Agile) 與 Scrum 框架，以及數據分析與視覺化技能。", image: IMAGES.google, images: [IMAGES.google, IMAGES.googleDataAnalytics] },
                { id: "n8n", title: "n8n Automation", subtitle: "Workflow Architect", tag: "Technical Skill", summary: "以最快速度將靈感轉化為解決方案。", details: "擅長透過 API 與自動化工具優化商業流程。", image: IMAGES.n8n, images: [IMAGES.n8n] }
            ];

            const certificateGroups = [
                { category: "Google 數位實作", items: [
                    { id: "goo-1", title: "Project Management", issuer: "Google", image: IMAGES.google, desc: "專案規劃與風險管理。" },
                    { id: "goo-2", title: "Data Analytics", issuer: "Google", image: IMAGES.googleDataAnalytics, desc: "數據分析與視覺化實務。" }
                ]},
                { category: "金融專業資格", items: [
                    { id: "fin-3", title: "信託業務專業", issuer: "信託業商業同業公會", image: IMAGES.trust, desc: "信託業務實務與法規。" },
                    { id: "fin-4", title: "銀行內部控制與內部稽核", issuer: "銀行公會", image: IMAGES.bankControl, desc: "銀行內控制度與稽核實務。" },
                    { id: "fin-5", title: "初階授信人員", issuer: "銀行公會", image: IMAGES.credit, desc: "授信業務基礎實務。" }
                ]},
                { category: "國際語言能力", items: [
                    { id: "lang-1", title: "TOEIC 多益英語測驗", issuer: "ETS", image: IMAGES.toeic, desc: "國際商務溝通與閱讀能力認證。" },
                    { id: "lang-2", title: "Cebu International Academy", issuer: "CIA", image: IMAGES.cebu, desc: "菲律賓語言學校畢業證書，需向左旋轉90度查看。", needsRotation: true }
                ]}
            ];

            const { scrollYProgress } = useScroll();
            const springProgress = useSpring(scrollYProgress, { stiffness: 100, damping: 30 });

            return (
                <div className="relative">
                    
                    {/* Simpsons Intro Overlay */}
                    {waitingStart && (
                        <div id="simpson-overlay" className="fixed inset-0 z-[150] flex items-center justify-center bg-black">
                            <iframe id="simpson-iframe" src="辛普森動畫index.html" className="absolute inset-0 w-full h-full border-0"></iframe>
                        </div>
                    )}

                    <canvas id="static-overlay" className="fixed inset-0 z-[250] opacity-0 pointer-events-none"></canvas>

                    {/* Typewriter Overlay - 全黑屏幕和打字機效果 */}
                    {showTypewriter && (
                        <div id="typewriter-overlay" className="fixed inset-0 z-[300] bg-black flex items-center justify-center">
                            <div className="text-center px-4 max-w-4xl">
                                <div className="text-2xl sm:text-3xl md:text-5xl lg:text-6xl font-light text-white mb-4 md:mb-6 tracking-wider">
                                    <div className="min-h-[3rem] md:min-h-[4rem] lg:min-h-[5rem] flex items-center justify-center">
                                        {typewriterText1}
                                        {(typewriterText1.length < 'HI! MY NAME IS OWEN'.length || (typewriterText1.length === 'HI! MY NAME IS OWEN'.length && typewriterText2.length === 0)) && (
                                            <span className="inline-block w-0.5 h-[1em] bg-white ml-2 animate-pulse" style={{ animation: 'blink 1s infinite' }}></span>
                                        )}
                                    </div>
                                </div>
                                <div className="text-2xl sm:text-3xl md:text-5xl lg:text-6xl font-light text-white tracking-wider">
                                    <div className="min-h-[3rem] md:min-h-[4rem] lg:min-h-[5rem] flex items-center justify-center">
                                        {typewriterText2}
                                        {typewriterText1.length === 'HI! MY NAME IS OWEN'.length && typewriterText2.length < 'WELCOME TO MY PORTFOLIO'.length && (
                                            <span className="inline-block w-0.5 h-[1em] bg-white ml-2 animate-pulse" style={{ animation: 'blink 1s infinite' }}></span>
                                        )}
                                    </div>
                                </div>
                            </div>
                            <style>{`
                                @keyframes blink {
                                    0%, 50% { opacity: 1; }
                                    51%, 100% { opacity: 0; }
                                }
                            `}</style>
                        </div>
                    )}

                    {/* Stage: Web Content */}
                    <div id="web-content" className={`relative z-10 ${stage === 'web' ? 'opacity-100 visible' : 'opacity-0 invisible'}`} style={{ display: stage === 'web' ? 'block' : 'none' }}>
                        {/* 背景層 */}
                        <div className="fixed inset-0 z-0 pointer-events-none">
                            <div className="absolute inset-0 bg-grid" />
                            <div className="absolute inset-0 bg-noise" />
                            <div className="absolute top-[5%] left-[5%] w-[50vw] h-[50vw] bg-blue-500/5 rounded-full blur-[140px]" />
                            <div className="absolute top-[60%] right-[10%] w-[40vw] h-[40vw] bg-purple-500/3 rounded-full blur-[120px]" />
                            <div className="absolute bottom-[10%] left-[20%] w-[30vw] h-[30vw] bg-cyan-500/4 rounded-full blur-[100px]" />
                            {/* 裝飾性線條 */}
                            <div className="absolute top-1/4 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent" />
                            <div className="absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/3 to-transparent" />
                            <div className="absolute top-3/4 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent" />
                            {/* 裝飾性點 */}
                            <div className="absolute top-[20%] right-[15%] w-2 h-2 bg-white/10 rounded-full" />
                            <div className="absolute top-[35%] right-[25%] w-1.5 h-1.5 bg-white/8 rounded-full" />
                            <div className="absolute top-[50%] left-[15%] w-1 h-1 bg-white/10 rounded-full" />
                            <div className="absolute bottom-[25%] right-[20%] w-2 h-2 bg-white/8 rounded-full" />
                        </div>

                        <motion.div className="fixed top-0 left-0 right-0 h-0.5 bg-white z-[60] origin-left" style={{ scaleX: springProgress }} />

                        <nav className="fixed top-0 w-full z-50">
                            <div className="max-w-7xl mx-auto px-2 sm:px-4 md:px-8 h-14 sm:h-16 md:h-20 flex items-center justify-between border-b border-white/5 backdrop-blur-md">
                                <div className="flex items-center gap-1 sm:gap-2 md:gap-3 font-medium tracking-tighter text-xs sm:text-sm md:text-lg uppercase flex-shrink-0">
                                    <div className="w-1 h-1 sm:w-1.5 sm:h-1.5 bg-white rounded-full animate-pulse" />
                                    <span className="hidden sm:inline">Studio Portfolio</span>
                                    <span className="sm:hidden text-[10px]">Portfolio</span>
                                </div>
                                <div className="flex items-center gap-1 sm:gap-2 md:gap-8 text-[7px] sm:text-[8px] md:text-[10px] tracking-[0.15em] sm:tracking-[0.2em] font-medium uppercase text-zinc-500 flex-shrink-0">
                                    <a href="#projects" className="md:inline whitespace-nowrap">Projects</a>
                                    <a href="#journey" className="md:inline whitespace-nowrap">Journey</a>
                                    <a href="#certs" className="md:inline whitespace-nowrap">Certs</a>
                                    <a href="mailto:connect@example.com" className="text-white border border-white/20 px-2 sm:px-3 md:px-6 py-0.5 sm:py-1 md:py-2 rounded-full bg-white/5 text-[7px] sm:text-[8px] md:text-[10px] whitespace-nowrap">Connect</a>
                                </div>
                            </div>
                        </nav>

                        <main className="max-w-7xl mx-auto px-4 md:px-8">
                            <section className="min-h-[70vh] flex flex-col justify-center pb-8 md:pb-12 pt-20 md:pt-0">
                                <p className="text-zinc-500 font-mono text-xs mb-8 tracking-[0.4em] uppercase">Vibe Coder / Architect</p>
                                <h1 className="text-[10vw] md:text-[8vw] font-light tracking-tighter leading-[0.8] mb-4 md:mb-6">
                                    DESIGNING <br />
                                    <span className="font-serif italic font-normal text-zinc-500 text-[11vw] md:text-[9vw]">Momentum.</span>
                                </h1>
                                <div className="flex items-center gap-8">
                                    <div className="h-px w-20 bg-zinc-700" />
                                    <p className="max-w-md text-zinc-500 text-sm leading-relaxed">將商業邏輯轉化為直觀且具備高度自動化的數位體驗。</p>
                                </div>
                            </section>

                            <section id="projects" className="mb-8 relative overflow-visible">
                                <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"></div>
                                {/* 裝飾性元素 */}
                                <div className="absolute top-8 right-8 w-32 h-32 border border-white/5 rounded-full opacity-20"></div>
                                <div className="absolute bottom-8 left-8 w-24 h-24 border border-white/5 rounded-full opacity-15"></div>
                                
                                {/* Section 下方的格子背景效果 - 手機和電腦都顯示 */}
                                <div className="absolute -bottom-4 left-0 right-0 h-32 opacity-[0.02] pointer-events-none" style={{
                                    backgroundImage: 'linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)',
                                    backgroundSize: '30px 30px',
                                    backgroundPosition: '0 0, 0 0'
                                }}></div>
                                <div 
                                    onClick={() => setActiveProjectModal(true)} 
                                    className="group relative cursor-pointer border border-white/10 rounded-[2.5rem] overflow-hidden bg-gradient-to-br from-white/[0.02] to-white/[0.005] hover:from-white/[0.05] hover:to-white/[0.02] transition-all duration-700 mt-8 backdrop-blur-sm shadow-[0_8px_32px_0_rgba(0,0,0,0.3)] hover:shadow-[0_12px_48px_0_rgba(255,255,255,0.1)]"
                                    style={{
                                        position: 'relative',
                                        isolation: 'isolate'
                                    }}
                                >
                                    {/* 背景光暈效果 */}
                                    <div className="absolute inset-0 bg-gradient-to-r from-blue-500/0 via-purple-500/5 to-cyan-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-700"></div>
                                    
                                    {/* 裝飾性網格背景 - 更明顯 */}
                                    <div className="absolute inset-0 opacity-[0.05] group-hover:opacity-[0.1] transition-opacity duration-700" style={{
                                        backgroundImage: 'linear-gradient(rgba(255,255,255,0.15) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.15) 1px, transparent 1px)',
                                        backgroundSize: '30px 30px',
                                        backgroundPosition: '0 0, 0 0'
                                    }}></div>
                                    
                                    {/* 下方格子效果 - 延伸到卡片外 */}
                                    <div className="absolute -bottom-8 left-0 right-0 h-24 opacity-[0.03] group-hover:opacity-[0.06] transition-opacity duration-700 pointer-events-none" style={{
                                        backgroundImage: 'linear-gradient(rgba(255,255,255,0.15) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.15) 1px, transparent 1px)',
                                        backgroundSize: '30px 30px',
                                        backgroundPosition: '0 0, 0 0'
                                    }}></div>
                                    
                                    {/* 邊框光效 */}
                                    <div className="absolute inset-0 rounded-[2.5rem] border border-white/10 group-hover:border-white/20 transition-all duration-700"></div>
                                    <div className="absolute -inset-[1px] rounded-[2.5rem] bg-gradient-to-r from-blue-500/0 via-purple-500/20 to-cyan-500/0 opacity-0 group-hover:opacity-100 blur-xl transition-opacity duration-700 -z-10"></div>
                                    
                                    <div className="py-32 px-12 flex flex-col items-center text-center relative z-10">
                                        {/* 加號圖標 - 更精緻 */}
                                        <div className="relative mb-10">
                                            <div className="w-20 h-20 border-2 border-zinc-700/50 rounded-full flex items-center justify-center text-3xl font-extralight text-zinc-400 group-hover:text-white group-hover:border-white/40 transition-all duration-500 group-hover:scale-110 group-hover:rotate-90">
                                                <span className="relative z-10">+</span>
                                            </div>
                                            {/* 加號周圍的光暈 */}
                                            <div className="absolute inset-0 rounded-full bg-white/5 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                                        </div>
                                        
                                        {/* 標題 - 更突出 */}
                                        <h2 className="text-6xl md:text-7xl font-light tracking-tighter mb-6 text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:via-zinc-300 group-hover:to-white transition-all duration-700">
                                            Project Matrix
                                        </h2>
                                        
                                        {/* 副標題 - 更精緻 */}
                                        <div className="flex items-center gap-4 mb-2">
                                            <div className="h-px w-12 bg-gradient-to-r from-transparent to-zinc-600 group-hover:to-zinc-400 transition-colors duration-500"></div>
                                            <p className="text-zinc-400 text-[11px] uppercase tracking-[0.6em] font-medium group-hover:text-zinc-300 transition-colors duration-500">
                                                Explore Artifacts
                                            </p>
                                            <div className="h-px w-12 bg-gradient-to-l from-transparent to-zinc-600 group-hover:to-zinc-400 transition-colors duration-500"></div>
                                        </div>
                                        
                                        {/* 提示文字 */}
                                        <p className="text-zinc-600 text-xs mt-4 opacity-0 group-hover:opacity-100 transition-opacity duration-500">
                                            Click to discover
                                        </p>
                                    </div>
                                    
                                    {/* 角落裝飾 */}
                                    <div className="absolute top-4 right-4 w-2 h-2 bg-zinc-700/30 rounded-full group-hover:bg-white/20 transition-colors duration-500"></div>
                                    <div className="absolute bottom-4 left-4 w-1.5 h-1.5 bg-zinc-700/30 rounded-full group-hover:bg-white/20 transition-colors duration-500"></div>
                                </div>
                            </section>

                            <section id="journey" className="mb-8 relative overflow-visible">
                                <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"></div>
                                {/* 裝飾性元素 */}
                                <div className="absolute top-12 right-12 w-20 h-20 border border-white/5 rounded-full opacity-15"></div>
                                <div className="absolute bottom-12 left-12 w-16 h-16 border border-white/5 rounded-full opacity-10"></div>
                                
                                {/* Section 下方的格子背景效果 */}
                                <div className="absolute -bottom-4 left-0 right-0 h-32 opacity-[0.02] pointer-events-none" style={{
                                    backgroundImage: 'linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)',
                                    backgroundSize: '30px 30px',
                                    backgroundPosition: '0 0, 0 0'
                                }}></div>
                                <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 border-t border-white/5 pt-8 relative mt-8">
                                    <div className="lg:col-span-4 lg:sticky lg:top-32 h-fit z-10">
                                        <h3 className="text-xs font-bold tracking-[0.6em] text-zinc-600 uppercase mb-6">Selected Journey</h3>
                                        <p ref={journeyDescriptionRef} className="text-xl font-light text-zinc-400 leading-tight min-h-[1.5em]">
                                            {journeyDescription}
                                            {journeyDescription.length < "Connecting the dots of experience to foster a vision that stops learning.".length && (
                                                <span className="animate-pulse ml-1">|</span>
                                            )}
                                        </p>
                                    </div>
                                    <div className="lg:col-span-8 space-y-3 relative pl-8 md:pl-0">
                                        {/* 時間軸 - 垂直線（桌面版） */}
                                        <div className="absolute left-0 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-white/10 to-transparent hidden md:block" style={{
                                            left: '20px'
                                        }}></div>
                                        
                                        {/* 時間軸 - 垂直線（手機版） */}
                                        <div className="absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-white/10 to-transparent md:hidden"></div>
                                        
                                        {experiences.map((exp, index) => {
                                            const expRef = useRef(null);
                                            const isInView = useInView(expRef, { once: false, amount: 0.2 });
                                            const isLast = index === experiences.length - 1;
                                            return (
                                                <motion.div
                                                    key={exp.id}
                                                    ref={expRef}
                                                    initial={{ 
                                                        opacity: 0, 
                                                        y: 50,
                                                        x: 30,
                                                        filter: 'brightness(0.5)'
                                                    }}
                                                    animate={isInView ? { 
                                                        opacity: 1, 
                                                        y: 0,
                                                        x: 0,
                                                        filter: 'brightness(1)'
                                                    } : { 
                                                        opacity: 0, 
                                                        y: 50,
                                                        x: 30,
                                                        filter: 'brightness(0.5)'
                                                    }}
                                                    transition={{ 
                                                        duration: 0.8, 
                                                        delay: index * 0.15,
                                                        ease: [0.25, 0.1, 0.25, 1]
                                                    }}
                                                    className="group relative py-8 md:py-12 transition-all duration-500 md:pl-12"
                                                >
                                                    {/* 左側裝飾線（桌面版） */}
                                                    <div className="absolute left-0 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-white/5 to-transparent hidden md:block opacity-0 group-hover:opacity-100 transition-opacity duration-500" style={{
                                                        left: '20px',
                                                        transform: 'translateX(-50%)',
                                                        height: '100%'
                                                    }}></div>
                                                    
                                                    {/* 時間軸節點（桌面版） */}
                                                    <div className="absolute left-0 top-1/2 -translate-y-1/2 hidden md:flex items-center justify-center" style={{
                                                        left: '20px',
                                                        width: '12px',
                                                        height: '12px',
                                                        transform: 'translate(-50%, -50%)'
                                                    }}>
                                                        {/* 外圈光暈 */}
                                                        <div className="absolute inset-0 rounded-full bg-white/10 blur-md opacity-0 group-hover:opacity-100 transition-opacity duration-500" style={{
                                                            width: '24px',
                                                            height: '24px'
                                                        }}></div>
                                                        {/* 節點圓點 */}
                                                        <div className="relative w-3 h-3 rounded-full bg-white/20 border-2 border-white/30 group-hover:bg-white/40 group-hover:border-white/50 transition-all duration-500 group-hover:scale-125 z-10"></div>
                                                        {/* 內圈 */}
                                                        <div className="absolute inset-0 rounded-full bg-white/5 group-hover:bg-white/10 transition-all duration-500" style={{
                                                            width: '8px',
                                                            height: '8px'
                                                        }}></div>
                                                    </div>
                                                    
                                                    {/* 時間軸節點（手機版） */}
                                                    <div className="absolute left-0 top-6 flex items-center justify-center md:hidden" style={{
                                                        left: '16px',
                                                        width: '8px',
                                                        height: '8px',
                                                        transform: 'translate(-50%, 0)'
                                                    }}>
                                                        <div className="relative w-2 h-2 rounded-full bg-white/20 border border-white/30 group-hover:bg-white/40 group-hover:border-white/50 transition-all duration-500"></div>
                                                    </div>
                                                    
                                                    {/* 內容區域 */}
                                                    <motion.div 
                                                        className="relative"
                                                        initial={{ opacity: 0 }}
                                                        animate={isInView ? { opacity: 1 } : { opacity: 0 }}
                                                        transition={{ duration: 0.6, delay: index * 0.15 + 0.3 }}
                                                    >
                                                        <div className="flex flex-col md:flex-row items-start gap-6">
                                                            <div className="space-y-4 flex-1">
                                                                <motion.span 
                                                                    className="text-[10px] font-bold tracking-widest text-zinc-500 uppercase px-2 py-1 border border-zinc-800 rounded inline-block"
                                                                    initial={{ opacity: 0, scale: 0.8 }}
                                                                    animate={isInView ? { opacity: 1, scale: 1 } : { opacity: 0, scale: 0.8 }}
                                                                    transition={{ duration: 0.4, delay: index * 0.15 + 0.4 }}
                                                                >
                                                                    {exp.tag}
                                                                </motion.span>
                                                                <motion.h4 
                                                                    className="text-3xl font-light group-hover:translate-x-2 transition-transform"
                                                                    initial={{ opacity: 0, x: -20 }}
                                                                    animate={isInView ? { opacity: 1, x: 0 } : { opacity: 0, x: -20 }}
                                                                    transition={{ duration: 0.6, delay: index * 0.15 + 0.5 }}
                                                                    style={{
                                                                        color: isInView ? '#ffffff' : '#71717a'
                                                                    }}
                                                                >
                                                                    {exp.title}
                                                                </motion.h4>
                                                                <motion.p 
                                                                    className="text-zinc-500 max-w-lg leading-relaxed"
                                                                    initial={{ opacity: 0 }}
                                                                    animate={isInView ? { opacity: 1 } : { opacity: 0 }}
                                                                    transition={{ duration: 0.6, delay: index * 0.15 + 0.6 }}
                                                                    style={{
                                                                        color: isInView ? '#71717a' : '#3f3f46'
                                                                    }}
                                                                >
                                                                    {exp.summary}
                                                                </motion.p>
                                                            </div>
                                                            <div className="flex gap-3 items-start flex-shrink-0">
                                                                {exp.images && exp.images.map((img, idx) => (
                                                                    <div key={idx} onClick={() => setActiveExpModal({...exp, selectedImage: img})} className="cursor-pointer">
                                                                        <img 
                                                                            src={img} 
                                                                            alt={exp.title}
                                                                            className="w-20 h-20 md:w-24 md:h-24 object-cover rounded-lg grayscale hover:grayscale-0 transition-all duration-300 border border-white/10"
                                                                            style={{
                                                                                filter: 'brightness(0.6) grayscale(100%)',
                                                                                transition: 'filter 0.3s ease'
                                                                            }}
                                                                            onMouseEnter={(e) => {
                                                                                e.target.style.filter = 'brightness(0.8) grayscale(0%)';
                                                                            }}
                                                                            onMouseLeave={(e) => {
                                                                                e.target.style.filter = 'brightness(0.6) grayscale(100%)';
                                                                            }}
                                                                        />
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        </div>
                                                        
                                                        {/* 底部分割線 */}
                                                        {!isLast && (
                                                            <motion.div 
                                                                className="mt-8 md:mt-12 h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"
                                                                initial={{ scaleX: 0 }}
                                                                animate={isInView ? { scaleX: 1 } : { scaleX: 0 }}
                                                                transition={{ duration: 0.6, delay: index * 0.15 + 0.8 }}
                                                            ></motion.div>
                                                        )}
                                                    </motion.div>
                                                </motion.div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </section>

                            <section id="certs" className="mb-8 relative overflow-visible">
                                <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"></div>
                                {/* 裝飾性元素 */}
                                <div className="absolute top-16 right-16 w-28 h-28 border border-white/5 rounded-full opacity-12"></div>
                                <div className="absolute bottom-16 left-16 w-20 h-20 border border-white/5 rounded-full opacity-10"></div>
                                
                                {/* Section 下方的格子背景效果 */}
                                <div className="absolute -bottom-4 left-0 right-0 h-32 opacity-[0.02] pointer-events-none" style={{
                                    backgroundImage: 'linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)',
                                    backgroundSize: '30px 30px',
                                    backgroundPosition: '0 0, 0 0'
                                }}></div>
                                <div className="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-8 border-t border-white/5 pt-8 mt-8">
                                    <h2 className="text-4xl font-light text-white">專業認證體系</h2>
                                    <p className="text-zinc-500 text-sm max-w-sm">跨足專案管理、自動化開發與金融實務。</p>
                                </div>
                                <div className="space-y-12">
                                    {certificateGroups.map((group, groupIdx) => {
                                        const groupRef = useRef(null);
                                        const isInView = useInView(groupRef, { once: false, amount: 0.2 });
                                        return (
                                            <motion.div
                                                key={groupIdx}
                                                ref={groupRef}
                                                initial={{ opacity: 0, y: 50 }}
                                                animate={isInView ? { opacity: 1, y: 0 } : { opacity: 0, y: 50 }}
                                                transition={{ duration: 0.6, delay: groupIdx * 0.15 }}
                                                className="grid grid-cols-1 lg:grid-cols-12 gap-12"
                                            >
                                                <div className="lg:col-span-3 text-xs font-bold tracking-[0.3em] uppercase text-zinc-600">{group.category}</div>
                                                <div className="lg:col-span-9 grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    {group.items.map((cert, certIdx) => (
                                                        <motion.div
                                                            key={cert.id}
                                                            initial={{ opacity: 0, x: -30 }}
                                                            animate={isInView ? { opacity: 1, x: 0 } : { opacity: 0, x: -30 }}
                                                            transition={{ duration: 0.5, delay: groupIdx * 0.15 + certIdx * 0.1 }}
                                                            onClick={() => setActiveCertModal({...cert, category: group.category})}
                                                            className="p-10 border border-white/5 rounded-2xl cursor-pointer hover:bg-white/[0.03] transition-all relative overflow-hidden backdrop-blur-sm group"
                                                            style={{
                                                                position: 'relative',
                                                                isolation: 'isolate'
                                                            }}
                                                        >
                                                            {/* 格子背景效果 */}
                                                            <div className="absolute inset-0 opacity-[0.03] group-hover:opacity-[0.06] transition-opacity duration-700 pointer-events-none" style={{
                                                                backgroundImage: 'linear-gradient(rgba(255,255,255,0.15) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.15) 1px, transparent 1px)',
                                                                backgroundSize: '30px 30px',
                                                                backgroundPosition: '0 0, 0 0'
                                                            }}></div>
                                                            
                                                            <div className="relative z-10">
                                                                <h5 className="text-xl font-light mb-2">{cert.title}</h5>
                                                                <p className="text-zinc-600 text-[10px] tracking-widest uppercase font-bold">{cert.issuer}</p>
                                                            </div>
                                                        </motion.div>
                                                    ))}
                                                </div>
                                            </motion.div>
                                        );
                                    })}
                                </div>
                            </section>

                            <footer className="py-32 border-t border-white/5 text-center">
                                <div className="text-[12vw] font-serif italic text-white/5 pointer-events-none select-none">Stay Forward.</div>
                                <div className="text-[10px] tracking-[0.5em] text-zinc-600 uppercase font-bold mt-12">© 2024 / Digital Identity</div>
                            </footer>
                        </main>
                    </div>

                    {/* Modals */}
                    <AnimatePresence>
                        {activeProjectModal && (
                            <motion.div 
                                key="proj-modal" 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }} 
                                className="fixed inset-0 z-[200] flex items-center justify-center p-4 md:p-6"
                                onAnimationStart={() => document.body.classList.add('modal-open')}
                                onExitComplete={() => {
                                    setTimeout(() => {
                                        document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                        setActiveProjectModal(false);
                                    }, 100);
                                }}
                            >
                                <div className="absolute inset-0 bg-black/80 backdrop-blur-3xl" onClick={() => {
                                    setActiveProjectModal(false);
                                    setTimeout(() => {
                                        document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                    }, 100);
                                }} />
                                <motion.div 
                                    initial={{ scale: 0.9, opacity: 0 }} 
                                    animate={{ scale: 1, opacity: 1 }} 
                                    exit={{ scale: 0.9, opacity: 0 }} 
                                    className="relative max-w-[95vw] lg:max-w-6xl w-full max-h-[90vh] bg-zinc-900 border border-white/10 rounded-[2.5rem] p-6 md:p-12 lg:p-20 overflow-y-auto custom-scrollbar"
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    <div className="flex justify-between items-start mb-12 md:mb-20">
                                        <h2 className="text-3xl md:text-5xl font-light text-white">Project Matrix</h2>
                                        <button onClick={() => {
                                            setActiveProjectModal(false);
                                            setTimeout(() => {
                                                document.body.classList.remove('modal-open');
                                                document.body.style.overflow = '';
                                                document.body.style.position = '';
                                                document.body.style.width = '';
                                                document.body.style.height = '';
                                            }, 100);
                                        }} className="text-3xl font-thin hover:text-white transition">×</button>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                                        {projects.map((p) => (
                                            <div key={p.id} className="p-8 md:p-10 border border-white/5 rounded-3xl hover:bg-white/[0.02] cursor-pointer transition-all" onClick={() => {
                                                setActiveProjectView(p);
                                                setActiveProjectModal(false);
                                                // 保持modal-open状态，因为会打开新的modal
                                            }}>
                                                <h4 className="text-xl md:text-2xl font-light mb-2 text-white">{p.title}</h4>
                                                <p className="text-zinc-500 text-sm">{p.desc}</p>
                                            </div>
                                        ))}
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}

                        {(activeExpModal || activeCertModal) && (
                            <motion.div key="info-modal" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="fixed inset-0 z-[200] flex items-center justify-center p-4 md:p-6">
                                <div className="absolute inset-0 bg-black/80 backdrop-blur-3xl" onClick={() => { setActiveExpModal(null); setActiveCertModal(null); }} />
                                <motion.div initial={{ y: 50, opacity: 0 }} animate={{ y: 0, opacity: 1 }} exit={{ y: 50, opacity: 0 }} className="relative bg-zinc-900 border border-white/10 max-w-5xl w-full max-h-[90vh] md:max-h-[85vh] overflow-hidden rounded-[2.5rem] flex flex-col lg:flex-row">
                                    <div className="lg:w-1/2 bg-zinc-800 h-64 lg:h-auto relative overflow-hidden flex items-center justify-center">
                                        <img 
                                            src={(activeExpModal?.selectedImage || activeExpModal?.image || activeCertModal?.image)} 
                                            className="w-full h-full object-contain grayscale-0 opacity-100"
                                            style={{ 
                                                transform: (activeCertModal?.needsRotation) ? 'rotate(-90deg)' : 'none',
                                                transition: 'transform 0.3s'
                                            }}
                                        />
                                    </div>
                                    <div className="lg:w-1/2 p-8 md:p-12 lg:p-16 overflow-y-auto custom-scrollbar">
                                        <button onClick={() => { setActiveExpModal(null); setActiveCertModal(null); }} className="float-right text-2xl font-thin hover:text-white transition">×</button>
                                        <span className="text-[10px] font-bold tracking-[0.3em] uppercase text-zinc-500">{(activeExpModal || activeCertModal).tag || (activeExpModal || activeCertModal).category}</span>
                                        <h2 className="text-4xl font-light text-white my-8">{(activeExpModal || activeCertModal).title}</h2>
                                        <p className="text-zinc-400 leading-relaxed">{(activeExpModal || activeCertModal).details || (activeExpModal || activeCertModal).desc}</p>
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}
                    </AnimatePresence>
                    <AnimatePresence>
                        {activeProjectView && (
                            <motion.div 
                                key="proj-view" 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }} 
                                className="fixed inset-0 z-[220] flex items-center justify-center p-2 md:p-4 lg:p-6"
                                onAnimationStart={() => document.body.classList.add('modal-open')}
                                onExitComplete={() => {
                                    document.body.classList.remove('modal-open');
                                }}
                            >
                                <div className="absolute inset-0 bg-black/80 backdrop-blur-3xl" onClick={() => {
                                    setActiveProjectView(null);
                                    setActiveProjectModal(false);
                                    setTimeout(() => {
                                        document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                    }, 100);
                                }} />
                                <motion.div 
                                    initial={{ y: 40, opacity: 0 }} 
                                    animate={{ y: 0, opacity: 1 }} 
                                    exit={{ y: 40, opacity: 0 }} 
                                    className="relative bg-zinc-900 border border-white/10 max-w-[95vw] lg:max-w-6xl w-full max-h-[95vh] rounded-[2rem] overflow-hidden flex flex-col"
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    <div className="flex justify-between items-center px-4 md:px-6 lg:px-8 py-4 md:py-6 border-b border-white/10 flex-shrink-0">
                                        <button onClick={() => { 
                                            setActiveProjectView(null);
                                            setActiveProjectModal(true);
                                            setTimeout(() => {
                                                document.body.classList.remove('modal-open');
                                                document.body.style.overflow = '';
                                                document.body.style.position = '';
                                                document.body.style.width = '';
                                                document.body.style.height = '';
                                            }, 100);
                                        }} className="text-sm text-zinc-400 hover:text-white transition mr-4">← 返回</button>
                                        <h3 className="text-xl md:text-2xl font-light text-white flex-1 text-center">{activeProjectView.title}</h3>
                                        <button onClick={() => { 
                                            setActiveProjectView(null);
                                            setActiveProjectModal(false);
                                            setTimeout(() => {
                                                document.body.classList.remove('modal-open');
                                                document.body.style.overflow = '';
                                                document.body.style.position = '';
                                                document.body.style.width = '';
                                                document.body.style.height = '';
                                            }, 100);
                                        }} className="text-2xl font-thin hover:text-white transition ml-4">×</button>
                                    </div>
                                    <div className="grid grid-cols-1 lg:grid-cols-2 flex-1 overflow-hidden min-h-0">
                                        <div className="bg-zinc-800 overflow-hidden min-h-[40vh] lg:min-h-0 relative" style={{ maxHeight: 'calc(95vh - 80px)' }}>
                                            <div className="absolute inset-0 flex items-center justify-center" style={{ 
                                                width: '100%',
                                                height: '100%'
                                            }}>
                                                <div style={{
                                                    width: `${100 / iframeScale}%`,
                                                    height: `${100 / iframeScale}%`,
                                                    transform: `scale(${iframeScale})`,
                                                    transformOrigin: 'center center',
                                                    position: 'relative'
                                                }}>
                                                    <iframe 
                                                        src={activeProjectView.url} 
                                                        className="border-0 bg-white w-full h-full" 
                                                        style={{ 
                                                            width: '100%',
                                                            height: '100%',
                                                            minHeight: '100%',
                                                            pointerEvents: 'auto',
                                                            display: 'block'
                                                        }}
                                                        allow="fullscreen"
                                                        sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-modals allow-top-navigation allow-pointer-lock"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                        <div className="p-4 md:p-6 lg:p-8 lg:p-10 overflow-y-auto custom-scrollbar" onWheel={(e) => e.stopPropagation()} style={{ maxHeight: 'calc(95vh - 80px)' }}>
                                            <h4 className="text-lg md:text-xl font-light text-white mb-4">功能特色</h4>
                                            <ul className="space-y-2 text-zinc-400 text-sm">
                                                {activeProjectView.features.map((f, idx) => (
                                                    <li key={idx}>• {f}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}
                    </AnimatePresence>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
